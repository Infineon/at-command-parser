<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AT Command Parser Library: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AT Command Parser Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Overview </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The AT Command Parser provides an AT command interface for use in applications.</p>
<h1><a class="anchor" id="section_features"></a>
Features and Functionality</h1>
<p >The AT Command Parser library manages string command input and output via a set of I/O functions provided by the application and handles parsing of the common AT command elements. An application installs a list of supported commands by registering a command table with the library. When a matching command is found in the input stream, the library will invoke a callback function provided by the application for parsing the command specific elements. The library also provides APIs to allow the application to generate messages to be output to the external host.</p>
<h1><a class="anchor" id="section_Log"></a>
Log messages</h1>
<ul>
<li>The AT Command Parser library disables all the debug log messages by default. Do the following to enable log messages:<ol type="1">
<li>Add <code>ENABLE_AT_CMD_LOGS</code> macro to the <code>DEFINES</code> in the application's Makefile. The Makefile entry would look like as follows: <div class="fragment"><div class="line">DEFINES+=ENABLE_AT_CMD_LOGS</div>
</div><!-- fragment --></li>
<li>Call the <code>cy_log_init()</code> function provided by the <em>cy-log</em> module. cy-log is part of the <em>connectivity-utilities</em> library. See <a href="https://Infineon.github.io/connectivity-utilities/api_reference_manual/html/group__logging__utils.html">connectivity-utilities library API documentation</a> for cy-log details.</li>
</ol>
</li>
</ul>
<h1><a class="anchor" id="section_code_snippet"></a>
Code Snippets</h1>
<h2><a class="anchor" id="snip1"></a>
Code Snippet 1: AT command parser library initialization and registration</h2>
<p >This code snippet demonstrates how to initialize AT command parser library and register the callback functions</p><ul>
<li>The following callback functions are registered<ul>
<li><code>transport_read_data()</code></li>
<li><code>transport_write_data()</code></li>
<li><code>at_cmd_refapp_transport_is_data_ready()</code></li>
</ul>
</li>
<li>The above callback functions will be invoked by AT command parser libary based on it's main loop to check for data ready ( at_cmd_refapp_transport_is_data_ready), and if data is ready it will invoke the transport_read_data and check for the syntax of AT command validity, if the command is valid then it will processes the command and invokes command callback to post message to application. <div class="fragment"><div class="line">cy_rslt_t snippet_atcmd_parser_init_and_registration()</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_struct" href="structat__cmd__params__t.html">at_cmd_params_t</a> params;</div>
<div class="line">  cy_rslt_t result;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Create the command message queue.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  result = cy_rtos_queue_init(msgq, AT_CMD_REF_APP_NUM_CMD_QUEUE_MSGS, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structat__cmd__msg__queue__t.html">at_cmd_msg_queue_t</a>));</div>
<div class="line"> </div>
<div class="line">  memset(&amp;params, 0, <span class="keyword">sizeof</span>(params));</div>
<div class="line">  params.<a class="code hl_variable" href="structat__cmd__params__t.html#a8e18b2c48151a6e9820f5de20db71fc9">cmd_msg_queue</a> = msgq;</div>
<div class="line">  params.<a class="code hl_variable" href="structat__cmd__params__t.html#a1a0a3bb068743af019988a96f6f865dd">is_data_ready</a> = at_cmd_refapp_transport_is_data_ready;</div>
<div class="line">  params.<a class="code hl_variable" href="structat__cmd__params__t.html#a1d5ee8d1a3ec2966f16b1716875943bf">read_data</a>     = transport_read_data;</div>
<div class="line">  params.<a class="code hl_variable" href="structat__cmd__params__t.html#a3dc0d9f5e019be42c334d04ca7c1be31">write_data</a>    = transport_write_data;</div>
<div class="line">  result = <a class="code hl_function" href="group__group__at__cmd__parser__functions.html#gabac6845afa2497525a57e5c11a112ebe">at_cmd_parser_init</a>(&amp;params);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Register command table.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  result = <a class="code hl_function" href="group__group__at__cmd__parser__functions.html#ga18e094843667017de7c72a759ce4e20f">at_cmd_parser_register_commands</a>(at_cmd_refapp_wcm_cmd_table, <span class="keyword">sizeof</span>(at_cmd_refapp_wcm_cmd_table) / <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structat__cmd__def__t.html">at_cmd_def_t</a>));</div>
<div class="line">  <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__at__cmd__parser__functions_html_ga18e094843667017de7c72a759ce4e20f"><div class="ttname"><a href="group__group__at__cmd__parser__functions.html#ga18e094843667017de7c72a759ce4e20f">at_cmd_parser_register_commands</a></div><div class="ttdeci">cy_rslt_t at_cmd_parser_register_commands(at_cmd_def_t *cmd_table, uint32_t num_cmds)</div><div class="ttdoc">Register a command table with the AT Command Parser library.</div></div>
<div class="ttc" id="agroup__group__at__cmd__parser__functions_html_gabac6845afa2497525a57e5c11a112ebe"><div class="ttname"><a href="group__group__at__cmd__parser__functions.html#gabac6845afa2497525a57e5c11a112ebe">at_cmd_parser_init</a></div><div class="ttdeci">cy_rslt_t at_cmd_parser_init(at_cmd_params_t *params)</div><div class="ttdoc">Initializes the AT Command Parser library.</div></div>
<div class="ttc" id="astructat__cmd__def__t_html"><div class="ttname"><a href="structat__cmd__def__t.html">at_cmd_def_t</a></div><div class="ttdoc">Command table entry.</div><div class="ttdef"><b>Definition:</b> at_command_parser.h:149</div></div>
<div class="ttc" id="astructat__cmd__msg__queue__t_html"><div class="ttname"><a href="structat__cmd__msg__queue__t.html">at_cmd_msg_queue_t</a></div><div class="ttdoc">Message queue structure for passing command messages.</div><div class="ttdef"><b>Definition:</b> at_command_parser.h:112</div></div>
<div class="ttc" id="astructat__cmd__params__t_html"><div class="ttname"><a href="structat__cmd__params__t.html">at_cmd_params_t</a></div><div class="ttdoc">Initialization parameters.</div><div class="ttdef"><b>Definition:</b> at_command_parser.h:212</div></div>
<div class="ttc" id="astructat__cmd__params__t_html_a1a0a3bb068743af019988a96f6f865dd"><div class="ttname"><a href="structat__cmd__params__t.html#a1a0a3bb068743af019988a96f6f865dd">at_cmd_params_t::is_data_ready</a></div><div class="ttdeci">at_cmd_transport_is_data_ready is_data_ready</div><div class="ttdoc">Pointer to is data ready function</div><div class="ttdef"><b>Definition:</b> at_command_parser.h:214</div></div>
<div class="ttc" id="astructat__cmd__params__t_html_a1d5ee8d1a3ec2966f16b1716875943bf"><div class="ttname"><a href="structat__cmd__params__t.html#a1d5ee8d1a3ec2966f16b1716875943bf">at_cmd_params_t::read_data</a></div><div class="ttdeci">at_cmd_transport_read_data read_data</div><div class="ttdoc">Pointer to read data function</div><div class="ttdef"><b>Definition:</b> at_command_parser.h:215</div></div>
<div class="ttc" id="astructat__cmd__params__t_html_a3dc0d9f5e019be42c334d04ca7c1be31"><div class="ttname"><a href="structat__cmd__params__t.html#a3dc0d9f5e019be42c334d04ca7c1be31">at_cmd_params_t::write_data</a></div><div class="ttdeci">at_cmd_transport_write_data write_data</div><div class="ttdoc">Pointer to write data function</div><div class="ttdef"><b>Definition:</b> at_command_parser.h:216</div></div>
<div class="ttc" id="astructat__cmd__params__t_html_a8e18b2c48151a6e9820f5de20db71fc9"><div class="ttname"><a href="structat__cmd__params__t.html#a8e18b2c48151a6e9820f5de20db71fc9">at_cmd_params_t::cmd_msg_queue</a></div><div class="ttdeci">cy_queue_t * cmd_msg_queue</div><div class="ttdoc">Pointer to the initialized message queue.</div><div class="ttdef"><b>Definition:</b> at_command_parser.h:213</div></div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="snip2"></a>
Code Snippet 2: AT command parser transport ready callback</h2>
<p >This code snippet demonstrates invocation of transport ready callback function</p><ul>
<li><code>at_cmd_refapp_transport_is_data_ready()</code></li>
<li>The above callback functions will be invoked by AT command parser libary based on it's main loop to check for data ready ( at_cmd_refapp_transport_is_data_ready), if data is ready <code>true</code> is returned else <code>false</code>. <div class="fragment"><div class="line"><span class="keywordtype">bool</span> snippet_atcmd_parser_is_transport_ready(<span class="keywordtype">void</span> *opaque)</div>
<div class="line">{</div>
<div class="line">   <span class="keyword">volatile</span> <span class="keywordtype">bool</span> is_transport_ready = <span class="keyword">false</span>;</div>
<div class="line">   is_transport_ready = at_cmd_refapp_protocol_usb_data_ready();</div>
<div class="line">   <span class="keywordflow">return</span> is_transport_ready;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="snip3"></a>
Code Snippet 3: AT command parser transport read data callback</h2>
<p >This code snippet demonstrates invocation of transport read callback function.</p><ul>
<li><code>transport_read_data()</code></li>
<li>The above callback functions will be invoked by AT command parser libary when data is ready via at_cmd_refapp_transport_is_data_ready() API. <div class="fragment"><div class="line"><span class="keyword">static</span> uint32_t snippet_atcmd_parser_transport_read_data(uint8_t *buffer, uint32_t size, <span class="keywordtype">void</span> *opaque)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span>  num_read = 0;</div>
<div class="line">  at_cmd_refapp_protocol_usb_read_data(buffer, size, &amp;num_read);</div>
<div class="line">  <span class="keywordflow">return</span> (uint32_t)num_read;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="snip4"></a>
Code Snippet 4: AT command parser transport write data callback</h2>
<p >This code snippet demonstrates invocation of transport write callback function.</p><ul>
<li><code>transport_write_data()</code></li>
<li>The above callback functions will be invoked by AT command parser libary when data is to be sent to the application. <br  />
 <div class="fragment"><div class="line">cy_rslt_t snippet_atcmd_parser_transport_write_data(uint8_t *buffer, uint32_t length, <span class="keywordtype">void</span> *opaque)</div>
<div class="line">{</div>
<div class="line">    cy_rslt_t result = CY_RSLT_SUCCESS;</div>
<div class="line">    result = at_cmd_refapp_protocol_usb_write(buffer, (uint32_t)strlen((<span class="keywordtype">char</span> *)buffer));</div>
<div class="line">    <span class="keywordflow">return</span> CY_RSLT_SUCCESS;</div>
<div class="line">}</div>
</div><!-- fragment --> </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>AT Command Parser Library</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
